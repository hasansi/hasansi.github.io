<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Syed Hasan">
    <meta name="description" content="Syed Hasan&#39;s personal website">
    <meta name="keywords" content="blog,developer,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Clustering"/>
<meta name="twitter:description" content="Clustering Project The meta data of each session that the hackers used to connect to the servers of a large technology firm. These are the features of the data:
 &lsquo;Session_Connection_Time&rsquo;: How long the session lasted in minutes &lsquo;Bytes Transferred&rsquo;: Number of MB transferred during session &lsquo;Kali_Trace_Used&rsquo;: Indicates if the hacker was using Kali Linux &lsquo;Servers_Corrupted&rsquo;: Number of server corrupted during the attack &lsquo;Pages_Corrupted&rsquo;: Number of pages illegally accessed &lsquo;Location&rsquo;: Location attack came from (Probably useless because the hackers used VPNs) &lsquo;WPM_Typing_Speed&rsquo;: Their estimated typing speed based on session logs."/>

    <meta property="og:title" content="Clustering" />
<meta property="og:description" content="Clustering Project The meta data of each session that the hackers used to connect to the servers of a large technology firm. These are the features of the data:
 &lsquo;Session_Connection_Time&rsquo;: How long the session lasted in minutes &lsquo;Bytes Transferred&rsquo;: Number of MB transferred during session &lsquo;Kali_Trace_Used&rsquo;: Indicates if the hacker was using Kali Linux &lsquo;Servers_Corrupted&rsquo;: Number of server corrupted during the attack &lsquo;Pages_Corrupted&rsquo;: Number of pages illegally accessed &lsquo;Location&rsquo;: Location attack came from (Probably useless because the hackers used VPNs) &lsquo;WPM_Typing_Speed&rsquo;: Their estimated typing speed based on session logs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.hasanai.com/projects/clustering/" />



    
      <base href="https://www.hasanai.com/projects/clustering/">
    
    <title>
  Clustering Â· Home
</title>

    
      <link rel="canonical" href="https://www.hasanai.com/projects/clustering/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://www.hasanai.com/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    
    
    <link rel="icon" type="image/png" href="https://www.hasanai.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://www.hasanai.com/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.58.3" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://www.hasanai.com/">
      Home
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.hasanai.com/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.hasanai.com/projects/">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.hasanai.com/industries/">Industries</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://www.hasanai.com/contact/">Contact me</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Clustering</h1>
    </header>

    

<h1 id="clustering-project">Clustering Project</h1>

<p>The meta data of each session that the hackers used to connect to the servers of a large technology firm. These are the features of the data:</p>

<ul>
<li>&lsquo;Session_Connection_Time&rsquo;: How long the session lasted in minutes</li>
<li>&lsquo;Bytes Transferred&rsquo;: Number of MB transferred during session</li>
<li>&lsquo;Kali_Trace_Used&rsquo;: Indicates if the hacker was using Kali Linux</li>
<li>&lsquo;Servers_Corrupted&rsquo;: Number of server corrupted during the attack</li>
<li>&lsquo;Pages_Corrupted&rsquo;: Number of pages illegally accessed</li>
<li>&lsquo;Location&rsquo;: Location attack came from (Probably useless because the hackers used VPNs)</li>
<li>&lsquo;WPM_Typing_Speed&rsquo;: Their estimated typing speed based on session logs.</li>
</ul>

<p>The technology firm has 3 potential hackers that perpetrated the attack. Their certain of the first two hackers but they aren&rsquo;t very sure if the third hacker was involved or not? Morever it&rsquo;s also known that the hackers trade off attacks. Meaning they should each have roughly the same amount of attacks. Let&rsquo;s figure out how many hackers were involved.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007f7f"># %load /home/ubuntu/projects/initialize.py</span>
<span style="color:#fff;font-weight:bold">import</span> findspark
findspark.init(<span style="color:#0ff;font-weight:bold">&#39;/home/ubuntu/spark-2.1.1-bin-hadoop2.7&#39;</span>)
<span style="color:#fff;font-weight:bold">import</span> pyspark
<span style="color:#fff;font-weight:bold">from</span> pyspark.sql <span style="color:#fff;font-weight:bold">import</span> SparkSession
app_name=<span style="color:#0ff;font-weight:bold">&#39;app&#39;</span>
spark=SparkSession.builder.appName(app_name).getOrCreate()</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">from</span> pyspark.ml.clustering <span style="color:#fff;font-weight:bold">import</span> KMeans

<span style="color:#007f7f"># Loads data.</span>
dataset = spark.read.csv(<span style="color:#0ff;font-weight:bold">&#34;data/hack_data.csv&#34;</span>,header=True,inferSchema=True)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataset.head()</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">Row(Session_Connection_Time=8.0, Bytes Transferred=391.09, Kali_Trace_Used=1, Servers_Corrupted=2.96, Pages_Corrupted=7.0, Location=&#39;Slovenia&#39;, WPM_Typing_Speed=72.37)</pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataset.describe().show()</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">+-------+-----------------------+------------------+------------------+-----------------+------------------+-----------+------------------+
|summary|Session_Connection_Time| Bytes Transferred|   Kali_Trace_Used|Servers_Corrupted|   Pages_Corrupted|   Location|  WPM_Typing_Speed|
+-------+-----------------------+------------------+------------------+-----------------+------------------+-----------+------------------+
|  count|                    334|               334|               334|              334|               334|        334|               334|
|   mean|     30.008982035928145| 607.2452694610777|0.5119760479041916|5.258502994011977|10.838323353293413|       null|57.342395209580864|
| stddev|     14.088200614636158|286.33593163576757|0.5006065264451406| 2.30190693339697|  3.06352633036022|       null| 13.41106336843464|
|    min|                    1.0|              10.0|                 0|              1.0|               6.0|Afghanistan|              40.0|
|    max|                   60.0|            1330.5|                 1|             10.0|              15.0|   Zimbabwe|              75.0|
+-------+-----------------------+------------------+------------------+-----------------+------------------+-----------+------------------+</pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataset.columns</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">[&#39;Session_Connection_Time&#39;,
 &#39;Bytes Transferred&#39;,
 &#39;Kali_Trace_Used&#39;,
 &#39;Servers_Corrupted&#39;,
 &#39;Pages_Corrupted&#39;,
 &#39;Location&#39;,
 &#39;WPM_Typing_Speed&#39;]</pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">from</span> pyspark.ml.linalg <span style="color:#fff;font-weight:bold">import</span> Vectors
<span style="color:#fff;font-weight:bold">from</span> pyspark.ml.feature <span style="color:#fff;font-weight:bold">import</span> VectorAssembler</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">feat_cols = [<span style="color:#0ff;font-weight:bold">&#39;Session_Connection_Time&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;Bytes Transferred&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;Kali_Trace_Used&#39;</span>,
             <span style="color:#0ff;font-weight:bold">&#39;Servers_Corrupted&#39;</span>, <span style="color:#0ff;font-weight:bold">&#39;Pages_Corrupted&#39;</span>,<span style="color:#0ff;font-weight:bold">&#39;WPM_Typing_Speed&#39;</span>]</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">vec_assembler = VectorAssembler(inputCols = feat_cols, outputCol=<span style="color:#0ff;font-weight:bold">&#39;features&#39;</span>)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">final_data = vec_assembler.transform(dataset)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">from</span> pyspark.ml.feature <span style="color:#fff;font-weight:bold">import</span> StandardScaler</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">scaler = StandardScaler(inputCol=<span style="color:#0ff;font-weight:bold">&#34;features&#34;</span>, outputCol=<span style="color:#0ff;font-weight:bold">&#34;scaledFeatures&#34;</span>, withStd=True, withMean=False)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007f7f"># Compute summary statistics by fitting the StandardScaler</span>
scalerModel = scaler.fit(final_data)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007f7f"># Normalize each feature to have unit standard deviation.</span>
cluster_final_data = scalerModel.transform(final_data)</code></pre></div>
<p>** Time to find out whether its 2 or 3 hackers! **</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">kmeans3 = KMeans(featuresCol=<span style="color:#0ff;font-weight:bold">&#39;scaledFeatures&#39;</span>,k=<span style="color:#ff0;font-weight:bold">3</span>)
kmeans2 = KMeans(featuresCol=<span style="color:#0ff;font-weight:bold">&#39;scaledFeatures&#39;</span>,k=<span style="color:#ff0;font-weight:bold">2</span>)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_k3 = kmeans3.fit(cluster_final_data)
model_k2 = kmeans2.fit(cluster_final_data)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">wssse_k3 = model_k3.computeCost(cluster_final_data)
wssse_k2 = model_k2.computeCost(cluster_final_data)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;With K=3&#34;</span>)
<span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;Within Set Sum of Squared Errors = &#34;</span> + <span style="color:#fff;font-weight:bold">str</span>(wssse_k3))
<span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;--&#39;</span>*<span style="color:#ff0;font-weight:bold">30</span>)
<span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;With K=2&#34;</span>)
<span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;Within Set Sum of Squared Errors = &#34;</span> + <span style="color:#fff;font-weight:bold">str</span>(wssse_k2))</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">With K=3
Within Set Sum of Squared Errors = 434.1492898715845
------------------------------------------------------------
With K=2
Within Set Sum of Squared Errors = 601.7707512676716</pre></div>
<p>Not much to be gained from the WSSSE, after all, we would expect that as K increases, the WSSSE decreases.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">for</span> k in <span style="color:#fff;font-weight:bold">range</span>(<span style="color:#ff0;font-weight:bold">2</span>,<span style="color:#ff0;font-weight:bold">9</span>):
    kmeans = KMeans(featuresCol=<span style="color:#0ff;font-weight:bold">&#39;scaledFeatures&#39;</span>,k=k)
    model = kmeans.fit(cluster_final_data)
    wssse = model.computeCost(cluster_final_data)
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;With K={}&#34;</span>.format(k))
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#34;Within Set Sum of Squared Errors = &#34;</span> + <span style="color:#fff;font-weight:bold">str</span>(wssse))
    <span style="color:#fff;font-weight:bold">print</span>(<span style="color:#0ff;font-weight:bold">&#39;--&#39;</span>*<span style="color:#ff0;font-weight:bold">30</span>)</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">With K=2
Within Set Sum of Squared Errors = 601.7707512676716
------------------------------------------------------------
With K=3
Within Set Sum of Squared Errors = 434.1492898715845
------------------------------------------------------------
With K=4
Within Set Sum of Squared Errors = 267.1336116887891
------------------------------------------------------------
With K=5
Within Set Sum of Squared Errors = 253.02085829439568
------------------------------------------------------------
With K=6
Within Set Sum of Squared Errors = 229.43601355424215
------------------------------------------------------------
With K=7
Within Set Sum of Squared Errors = 213.299036334385
------------------------------------------------------------
With K=8
Within Set Sum of Squared Errors = 193.97042679220849
------------------------------------------------------------</pre></div>
<p>** Nothing definitive can be said with the above, but one key fact that the firm mentioned was that the attacks should be evenly numbered between the hackers. Let&rsquo;s check with the transform and prediction columns that result form this.**</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_k3.transform(cluster_final_data).groupBy(<span style="color:#0ff;font-weight:bold">&#39;prediction&#39;</span>).count().show()</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">+----------+-----+
|prediction|count|
+----------+-----+
|         1|   84|
|         2|  167|
|         0|   83|
+----------+-----+</pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_k2.transform(cluster_final_data).groupBy(<span style="color:#0ff;font-weight:bold">&#39;prediction&#39;</span>).count().show()</code></pre></div><div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">+----------+-----+
|prediction|count|
+----------+-----+
|         1|  167|
|         0|  167|
+----------+-----+</pre></div>
<hr />

<h3 id="so-it-was-2-hackers-as-the-count-is-evenly-distributed-as-required-by-problem-statement">So it was 2 hackers, as the count is evenly distributed as required by problem statement!</h3>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
